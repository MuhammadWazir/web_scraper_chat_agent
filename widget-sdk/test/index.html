<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Widget Test</title>
</head>

<body style="font-family: sans-serif; padding: 20px;">
    <h1>Widget Test Page</h1>
    <p>This page tests the web-scraper-chat-widget integration.</p>

    <div id="widget-container"></div>

    <!-- Load the widget from the dist folder -->
    <script src="../dist/widget.umd.js"></script>

    <script>
        async function initWidget() {
            // Configuration
            const BACKEND_URL = 'http://localhost:8000';
            const TOKEN = prompt("Enter your Widget Session Token (get this from the backend or manually create one via /widget/generate-url):");
            localStorage.setItem('auth_token', "Bearer cal_live_c53560a5c6282c1f2dea5102baf08fbd");
            const AUTH_TOKEN = localStorage.getItem('auth_token');
            if (!TOKEN) {
                alert("Session Token is required to test the widget.");
                return;
            }

            try {
                // Initialize the widget
                const widget = new window.ChatWidget({
                    baseUrl: BACKEND_URL,
                    authToken: AUTH_TOKEN
                });

                await widget.init(TOKEN);
                widget.render('#widget-container');
                console.log("Widget initialized successfully");
            } catch (error) {
                console.error("Failed to initialize widget:", error);
                alert("Failed to initialize widget. Check console for details.");
            }
        }

        // Add a button to start manual testing
        const btn = document.createElement('button');
        btn.textContent = 'Initialize Widget';
        btn.onclick = initWidget;
        btn.style.padding = '10px 20px';
        btn.style.fontSize = '16px';
        btn.style.marginTop = '20px';
        document.body.appendChild(btn);
    </script>
</body>

</html>